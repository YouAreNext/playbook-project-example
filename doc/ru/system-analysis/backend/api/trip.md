# API: Маршруты (`/trips`)

Этот ресурс отвечает за создание и управление маршрутами путешествий пользователя.

## `POST /trips`

**Назначение:** Инициирует асинхронную генерацию нового маршрута путешествия на основе текстового запроса пользователя. Система немедленно возвращает ID созданной задачи и начинает обработку в фоновом режиме.

**Request Body (`application/json`):**

| Поле | Тип | Описание | Обязательное |
|---|---|---|---|
| `prompt` | String | Текстовый запрос пользователя для генерации маршрута. Максимум 1000 символов. | Да |

**Пример Request Body:**
```json
{
  "prompt": "Поездка в Лиссабон на 4 дня для двоих. Любим керамику, морепродукты и нетуристические смотровые площадки. Бюджет 500 евро."
}
```

**Responses:**

*   **`202 Accepted`** - Запрос на генерацию успешно принят в обработку. Клиенту следует использовать `tripId` для отслеживания статуса или получения результата.
    ```json
    {
      "tripId": "a1b2c3d4-e5f6-7890-1234-567890abcdef",
      "status": "PROCESSING",
      "message": "Your trip generation has been queued."
    }
    ```
*   **`401 Unauthorized`** - Пользователь не аутентифицирован.
    ```json
    {
      "error": "Authentication required."
    }
    ```
*   **`422 Unprocessable Entity`** - Ошибка валидации. Например, текст запроса пуст или превышает лимит.
    ```json
    {
      "error": "Validation failed",
      "details": {
        "prompt": "Prompt must not be empty and should be less than 1000 characters."
      }
    }
    ```

---
## `GET /trips`

**Назначение:** Получение списка всех маршрутов, созданных текущим аутентифицированным пользователем. Возвращает краткую информацию о каждом маршруте с пагинацией.

**Query Params:**

| Параметр | Тип | Описание | Обязательное |
|---|---|---|---|
| `page` | Integer | Номер страницы для пагинации (начиная с 1). По умолчанию: 1. | Нет |
| `limit` | Integer | Количество маршрутов на странице. По умолчанию: 10. | Нет |

**Responses:**

*   **`200 OK`** - Успешный ответ со списком маршрутов.
    ```json
    {
      "page": 1,
      "limit": 10,
      "total": 2,
      "items": [
        {
          "tripId": "a1b2c3d4-e5f6-7890-1234-567890abcdef",
          "title": "Поездка в Лиссабон на 4 дня...",
          "status": "COMPLETED",
          "createdAt": "2025-09-10T12:00:00Z"
        },
        {
          "tripId": "f0e9d8c7-b6a5-4321-fedc-ba9876543210",
          "title": "Римские каникулы на неделю...",
          "status": "PROCESSING",
          "createdAt": "2025-09-11T15:30:00Z"
        }
      ]
    }
    ```
*   **`401 Unauthorized`** - Пользователь не аутентифицирован.
    ```json
    {
      "error": "Authentication required."
    }
    ```

---
## `GET /trips/{tripId}`

**Назначение:** Получение полной, детализированной информации о конкретном маршруте по его ID. Может использоваться для проверки статуса или для загрузки готового результата.

**Path Params:**

| Параметр | Тип | Описание | Обязательное |
|---|---|---|---|
| `tripId` | String (UUID) | Уникальный идентификатор маршрута. | Да |

**Responses:**

*   **`200 OK`** - Успешный ответ с данными готового маршрута.
    ```json
    {
      "tripId": "a1b2c3d4-e5f6-7890-1234-567890abcdef",
      "status": "COMPLETED",
      "originalPrompt": "Поездка в Лиссабон на 4 дня...",
      "createdAt": "2025-09-10T12:00:00Z",
      "plan": [
        {
          "day": 1,
          "title": "Знакомство с Алфамой",
          "locations": [
            {
              "name": "Замок Святого Георгия",
              "description": "Начните день с панорамных видов на город.",
              "time": "10:00 - 12:00",
              "coordinates": {
                "lat": 38.7139,
                "lng": -9.1335
              }
            },
            {
              "name": "Ресторан 'Pateo 13'",
              "description": "Аутентичный ресторан с морепродуктами, рекомендованный местными.",
              "time": "13:00 - 14:30",
              "coordinates": {
                "lat": 38.7115,
                "lng": -9.1301
              }
            }
          ]
        }
      ]
    }
    ```
*   **`200 OK` (Processing)** - Маршрут все еще находится в процессе генерации.
    ```json
    {
      "tripId": "f0e9d8c7-b6a5-4321-fedc-ba9876543210",
      "status": "PROCESSING"
    }
    ```
*   **`401 Unauthorized`** - Пользователь не аутентифицирован.
    ```json
    {
      "error": "Authentication required."
    }
    ```
*   **`404 Not Found`** - Маршрут с указанным ID не найден или не принадлежит текущему пользователю.
    ```json
    {
      "error": "Trip not found."
    }
    ```